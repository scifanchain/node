# 🚀 Gestell Node 快速上手指南

## 1️⃣ 安装依赖

```bash
cd D:\scifan\gestell-node
npm install
```

## 2️⃣ 配置环境（可选）

默认配置已经设置好，如需修改：

```bash
# 编辑 .env 文件
notepad .env
```

## 3️⃣ 运行节点

### 方式 A: 直接运行（推荐用于测试）

```bash
npm run dev
```

### 方式 B: 构建后运行（推荐用于生产）

```bash
# 构建
npm run build

# 运行
npm start
```

### 方式 C: 使用 PowerShell 脚本

```bash
# Windows
.\start.ps1
```

### 方式 D: Docker 容器（推荐用于部署）

```bash
docker-compose up -d
```

## 4️⃣ 查看状态

运行成功后，你会看到：

```
═══════════════════════════════════════════════════
  🚀 Gestell P2P Node Starting...  
═══════════════════════════════════════════════════

📋 配置信息:
   数据库路径: ./data/gestell-node.db
   工作空间ID: default-workspace

📊 数据库状态:
   当前版本: 0
   变更记录: 0 条

═══════════════════════════════════════════════════
  ✅ Gestell P2P Node 运行中  
═══════════════════════════════════════════════════

💡 按 Ctrl+C 停止节点
```

## 5️⃣ 连接客户端

节点运行后，Gestell 桌面客户端会自动发现并连接到此节点。

确保客户端配置了相同的：
- `WORKSPACE_ID`
- `SIGNALING_URL`
- `RELAY_URL`

## 6️⃣ 监控运行

节点会每分钟输出状态信息：

```
[14:30:00] 📊 状态: 版本 12345 | 100 条变更
```

## 7️⃣ 停止节点

按 `Ctrl + C` 优雅关闭：

```
═══════════════════════════════════════════════════
  🛑 收到 SIGINT 信号，正在关闭...  
═══════════════════════════════════════════════════

📊 最终统计:
   总变更: 100 条
   版本范围: 1 - 12345

🗄️  关闭数据库...
✅ 数据库已关闭

👋 再见！
```

## 🐛 常见问题

### 问题: 找不到 CR-SQLite 扩展

**解决**:
```bash
npm rebuild better-sqlite3
npm rebuild @vlcn.io/crsqlite
```

### 问题: 端口被占用

**解决**: P2P 节点不需要监听端口，如有冲突请检查其他服务。

### 问题: 无法连接到 P2P 服务器

**解决**: 检查网络和防火墙设置，确保可以访问 `106.53.71.197:2026`

## 📚 更多信息

详见完整文档：[README.md](./README.md)
